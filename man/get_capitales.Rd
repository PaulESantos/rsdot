% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_capitales.R
\name{get_capitales}
\alias{get_capitales}
\title{Obtener Capitales Distritales del Perú}
\usage{
get_capitales(
  departamento = NULL,
  provincia = NULL,
  distrito = NULL,
  show_progress = TRUE,
  force_update = FALSE
)
}
\arguments{
\item{departamento}{Character vector. Nombre(s) del/los departamento(s) a descargar.
Opciones válidas: "AMAZONAS", "ANCASH", "APURIMAC", "AREQUIPA", "AYACUCHO",
"CAJAMARCA", "CALLAO", "CUSCO", "HUANCAVELICA", "HUANUCO", "ICA", "JUNIN",
"LA LIBERTAD", "LAMBAYEQUE", "LIMA", "LORETO", "MADRE DE DIOS", "MOQUEGUA",
"PASCO", "PIURA", "PUNO", "SAN MARTIN", "TACNA", "TUMBES", "UCAYALI".
No distingue entre mayúsculas y minúsculas. Si es \code{NULL}, muestra la
lista de departamentos disponibles.}

\item{provincia}{Character vector. Nombre(s) de provincia(s) para filtrar los
resultados (opcional). Se aplica después de cargar los datos.}

\item{distrito}{Character vector. Nombre(s) de distrito(s) para filtrar los
resultados (opcional). Se aplica después de cargar los datos.}

\item{show_progress}{Logical. Si \code{TRUE} (por defecto), muestra mensajes
informativos sobre el progreso de la descarga. Si \code{FALSE}, ejecuta de
forma silenciosa.}

\item{force_update}{Logical. Si \code{TRUE}, fuerza una nueva descarga del
archivo incluso si existe en caché. Por defecto \code{FALSE}.}
}
\value{
Un objeto \code{sf} (simple feature) con geometría tipo POINT
que contiene información de capitales distritales, incluyendo:
\itemize{
\item Geometría POINT (ubicación de la capital)
\item \code{gid}: Identificador único del registro
\item \code{ubigeo}: Código de ubicación geográfica (6 dígitos)
\item \code{nombdep}: Nombre del departamento
\item \code{nombprov}: Nombre de la provincia
\item \code{nombdist}: Nombre del distrito
\item \code{codccpp}: Código del centro poblado (10 dígitos)
\item \code{cen_pob}: Nombre del centro poblado
\item \code{pob}: Población total
\item \code{capital}: Tipo de capital (1=departamental, 2=provincial, 3=distrital)
}

Si se solicitan múltiples departamentos, retorna un objeto sf combinado.
}
\description{
Descarga y carga la información de capitales distritales identificadas en el
Censo de Población y Vivienda 2017 del Instituto Nacional de Estadística e
Informática (INEI). Los datos incluyen información demográfica y geográfica de
las capitales a nivel departamental, provincial y distrital, con geometría tipo
POINT.
}
\details{
La función descarga datos desde OSF (Open Science Framework) y los almacena
en caché durante la sesión de R. Los datos están en formato GeoPackage (.gpkg).

El caché se almacena en: \code{tempdir()/DEMARCA_cache/capitales/}

\strong{NOTA:} Las geometrías son tipo POINT y representan la ubicación geográfica
aproximada de las capitales según el Censo 2017. Los datos de población
corresponden al año censal.
}
\examples{
\dontrun{
# Ver departamentos disponibles
get_capitales()

# Cargar capitales de un departamento
capitales_cusco <- get_capitales(departamento = "CUSCO")

# Cargar múltiples departamentos
capitales_sur <- get_capitales(
  departamento = c("CUSCO", "PUNO", "AREQUIPA")
)

# Filtrar por provincia
capitales_lima_prov <- get_capitales(
  departamento = "LIMA",
  provincia = "LIMA"
)

# Filtrar por distrito
capital_cusco_dist <- get_capitales(
  departamento = "CUSCO",
  provincia = "CUSCO",
  distrito = "CUSCO"
)

# Visualización con ggplot2
library(ggplot2)
library(dplyr)

# Mapa de capitales por jerarquía
ggplot(capitales_cusco) +
  geom_sf(aes(color = factor(capital), size = pob), alpha = 0.7) +
  scale_color_manual(
    values = c("1" = "red", "2" = "blue", "3" = "green"),
    labels = c("Departamental", "Provincial", "Distrital"),
    name = "Tipo de Capital"
  ) +
  scale_size_continuous(range = c(1, 10), name = "Población") +
  labs(
    title = "Capitales de Cusco por Jerarquía",
    subtitle = "Censo de Población y Vivienda 2017",
    caption = "Fuente: INEI | Visor - SDOT"
  ) +
  theme_minimal()

# Análisis de población por tipo de capital
capitales_cusco |>
  st_drop_geometry() |>
  group_by(capital) |>
  summarise(
    n = n(),
    pob_total = sum(pob, na.rm = TRUE),
    pob_promedio = mean(pob, na.rm = TRUE),
    pob_mediana = median(pob, na.rm = TRUE)
  ) |>
  arrange(capital)

# Capitales más pobladas
capitales_cusco |>
  st_drop_geometry() |>
  arrange(desc(pob)) |>
  select(nombdist, cen_pob, pob, capital) |>
  head(10)

# Filtrar solo capitales provinciales
caps_prov <- capitales_cusco |>
  filter(capital == 2)

# Análisis por provincia
capitales_cusco |>
  st_drop_geometry() |>
  group_by(nombprov) |>
  summarise(
    n_capitales = n(),
    pob_total = sum(pob, na.rm = TRUE)
  ) |>
  arrange(desc(pob_total))
}

}
\references{
INEI. Censo de Población y Vivienda 2017. Instituto Nacional de Estadística
e Informática.

Visor SDOT: \url{https://geosdot.servicios.gob.pe/visor/}
}
\seealso{
\code{\link{get_centros_poblados}}, \code{\link{get_departamentos}},
\code{\link[sf]{read_sf}}
}
