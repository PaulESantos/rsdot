% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/get_ccpp_tasa_crecimiento.R
\name{get_centros_poblados_crecimiento}
\alias{get_centros_poblados_crecimiento}
\title{Obtener Centros Poblados con Tasa de Crecimiento Poblacional}
\usage{
get_centros_poblados_crecimiento(
  departamento = NULL,
  provincia = NULL,
  distrito = NULL,
  show_progress = TRUE,
  force_update = FALSE
)
}
\arguments{
\item{departamento}{Character vector. Nombre(s) del/los departamento(s) a descargar.
Opciones válidas: "AMAZONAS", "ANCASH", "APURIMAC", "AREQUIPA", "AYACUCHO",
"CAJAMARCA", "CALLAO", "CUSCO", "HUANCAVELICA", "HUANUCO", "ICA", "JUNIN",
"LA LIBERTAD", "LAMBAYEQUE", "LIMA", "LORETO", "MADRE DE DIOS", "MOQUEGUA",
"PASCO", "PIURA", "PUNO", "SAN MARTIN", "TACNA", "TUMBES", "UCAYALI".
No distingue entre mayúsculas y minúsculas. Si es \code{NULL}, muestra la
lista de departamentos disponibles.}

\item{provincia}{Character vector. Nombre(s) de la(s) provincia(s) para filtrar
dentro del/los departamento(s) especificado(s). Opcional.}

\item{distrito}{Character vector. Nombre(s) del/los distrito(s) para filtrar
dentro de la(s) provincia(s) especificada(s). Opcional.}

\item{show_progress}{Logical. Si \code{TRUE} (por defecto), muestra mensajes
informativos sobre el progreso de la descarga. Si \code{FALSE}, ejecuta de
forma silenciosa.}

\item{force_update}{Logical. Si \code{TRUE}, fuerza una nueva descarga del
archivo incluso si existe en caché. Por defecto \code{FALSE}.}
}
\value{
Un objeto \code{sf} (simple feature) con geometría tipo POINT que contiene
información de los centros poblados y su tasa de crecimiento, incluyendo:
\itemize{
\item Geometría POINT (coordenadas del centro poblado)
\item \code{nro}: Número de identificación
\item \code{codccpp}: Código de centro poblado
\item \code{ubigeo}: Código UBIGEO del distrito
\item \code{dep}: Nombre del departamento
\item \code{prov}: Nombre de la provincia
\item \code{distrito}: Nombre del distrito
\item \code{centro_pob}: Nombre del centro poblado
\item \code{pob_2007}: Población en el censo 2007
\item \code{pob_2017}: Población en el censo 2017
\item \code{tasa}: Tasa media de crecimiento anual (\%)
\item \code{capital}: Tipo de capital (Departamental, Provincial, Distrital, No es capital)
\item \code{region}: Región natural (Costa, Sierra, Selva)
\item \code{urb_rural}: Clasificación urbano/rural
\item \code{tc_catg}: Categoría de tasa de crecimiento (POSITIVO, NEGATIVO)
}

Si se solicitan múltiples departamentos, retorna un objeto sf combinado.
}
\description{
Descarga y carga la información de centros poblados con su tasa media de
crecimiento anual poblacional intercensal (2007-2017) desde el repositorio
OSF de DEMARCA. Los datos incluyen geometría tipo POINT y permiten identificar
los cambios de volumen poblacional de cada centro poblado. Permite filtrado
escalonado por departamento, provincia y distrito.
}
\details{
La función descarga datos desde OSF (Open Science Framework) y los almacena
en caché durante la sesión de R. Los datos están en formato GeoPackage (.gpkg).

\strong{Metodología de los datos:}
\itemize{
\item Fuente: Censos de Población INEI 2007 y 2017
\item Nivel: Centro poblado
\item Variable: Tasa media de crecimiento anual intercensal
\item Aplicación: Análisis territorial para creaciones distritales
}

\strong{Filtrado jerárquico:}
Los filtros se aplican en cascada:
\enumerate{
\item Primero se cargan los departamentos especificados
\item Luego se filtran las provincias (si se especifican)
\item Finalmente se filtran los distritos (si se especifican)
}

El caché se almacena en: \code{tempdir()/DEMARCA_cache/centros_poblados/}

\strong{NOTA:} Las geometrías son tipo POINT (puntos) y representan la ubicación
de cada centro poblado.
}
\examples{
\dontrun{
# Ver departamentos disponibles
get_centros_poblados_crecimiento()

# Cargar centros poblados de un departamento completo
ccpp_cusco <- get_centros_poblados_crecimiento(departamento = "CUSCO")

# Filtrar por provincia específica
ccpp_prov_cusco <- get_centros_poblados_crecimiento(
  departamento = "CUSCO",
  provincia = "CUSCO"
)

# Filtrar por distrito específico
ccpp_wanchaq <- get_centros_poblados_crecimiento(
  departamento = "CUSCO",
  provincia = "CUSCO",
  distrito = "WANCHAQ"
)

# Cargar múltiples departamentos
ccpp_sur <- get_centros_poblados_crecimiento(
  departamento = c("CUSCO", "PUNO", "AREQUIPA")
)

# Visualización con ggplot2
library(ggplot2)
library(dplyr)

# Mapa de centros poblados por categoría de crecimiento
ggplot(ccpp_cusco) +
  geom_sf(aes(color = tc_catg, size = pob_2017), alpha = 0.6) +
  scale_color_manual(
    values = c("POSITIVO" = "darkgreen", "NEGATIVO" = "darkred"),
    name = "Crecimiento"
  ) +
  scale_size_continuous(
    name = "Población 2017",
    range = c(0.5, 5)
  ) +
  labs(
    title = "Centros Poblados del Departamento de Cusco",
    subtitle = "Tasa de Crecimiento Poblacional 2007-2017",
    caption = "Fuente: INEI | Visor - SDOT"
  ) +
  theme_minimal()

# Filtrar centros poblados por características
ccpp_urbanos <- ccpp_cusco |>
  filter(urb_rural == "URBANA")

ccpp_capitales <- ccpp_cusco |>
  filter(capital != "No es capital")

# Centros poblados con mayor crecimiento
top_crecimiento <- ccpp_cusco |>
  arrange(desc(tasa)) |>
  head(10)

ggplot(top_crecimiento) +
  geom_sf(aes(size = tasa, color = tasa)) +
  scale_color_gradient(low = "yellow", high = "red", name = "Tasa (\%)") +
  scale_size_continuous(range = c(3, 10), name = "Tasa (\%)") +
  geom_sf_text(
    aes(label = centro_pob),
    size = 2.5,
    nudge_y = 0.05
  ) +
  labs(
    title = "Top 10 Centros Poblados con Mayor Crecimiento",
    subtitle = "Departamento de Cusco (2007-2017)",
    caption = "Fuente: INEI | Visor - SDOT"
  ) +
  theme_minimal()

# Análisis por región natural
ccpp_cusco |>
  group_by(region, tc_catg) |>
  summarise(
    n_centros = n(),
    pob_total_2017 = sum(pob_2017, na.rm = TRUE),
    tasa_promedio = mean(tasa, na.rm = TRUE),
    .groups = "drop"
  )

# Comparación urbano vs rural
ggplot(ccpp_cusco) +
  geom_boxplot(aes(x = urb_rural, y = tasa, fill = urb_rural)) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Distribución de Tasas de Crecimiento",
    subtitle = "Por área urbana y rural - Cusco",
    x = "Clasificación",
    y = "Tasa de Crecimiento (\%)",
    caption = "Fuente: INEI | Visor - SDOT"
  ) +
  theme_minimal() +
  theme(legend.position = "none")
}

}
\references{
INEI. Censos Nacionales de Población y Vivienda 2007 y 2017.

Repositorio DEMARCA en OSF: \url{https://osf.io/qy4j6/}
}
\seealso{
\code{\link{get_densidad_poblacional}}, \code{\link{get_departamentos}},
\code{\link{get_provincias}}, \code{\link{get_distritos}},
\code{\link[sf]{read_sf}}
}
